# Resolving the Contraction Deficit in the Lyapunov Analysis of Consensus-Based Optimization on the Stiefel Manifold

## The Archetype of Contraction: A Review of the Euclidean CBO Convergence Proof

To fully diagnose the challenges encountered on the Stiefel manifold, it is instructive to first meticulously reconstruct the convergence proof for Consensus-Based Optimization (CBO) in the unconstrained Euclidean setting. This analysis, primarily based on the framework established in recent literature (\url{https://arxiv.org/abs/2103.15130}), serves as a critical baseline, highlighting the fundamental mechanisms that facilitate the proof of contraction. The success in Euclidean space provides a clear archetype against which the geometric complexities of the Stiefel manifold can be contrasted.

### The Euclidean CBO Mean-Field Dynamics

The CBO methodology models the evolution of a particle density, $\rho_t$, in the space of probability measures. In the mean-field limit, the behavior of an infinite ensemble of interacting particles is captured by the dynamics of a single representative particle, $X_t \in \mathbb{R}^{n \times k}$, governed by a stochastic differential equation (SDE). This mean-field SDE is given by (\url{https://arxiv.org/abs/2103.15130}):
$$dX_t = -\lambda(X_t - X_{\alpha,t})dt + \sigma\|X_t - X_{\alpha,t}\|_F dB_t$$
where:
*   $\lambda > 0$ is the drift parameter, controlling the rate of attraction towards the consensus point.
*   $\sigma > 0$ is the diffusion parameter, regulating the magnitude of stochastic exploration.
*   $B_t$ is a standard Brownian motion on the matrix space $\mathbb{R}^{n \times k}$.
*   $X_{\alpha,t}$ is the instantaneous consensus point, defined as a weighted average of particle positions, where the weights are determined by an objective function $\mathcal{E}$ and a concentration parameter $\alpha > 0$:
    $$
    X_{\alpha,t} := \frac{\mathbb{E}[X_t e^{-\alpha \mathcal{E}(X_t)}]}{\mathbb{E}[e^{-\alpha \mathcal{E}(X_t)}]}
    $$
    This formulation is motivated by Laplace's principle, which ensures that as $\alpha \to \infty$, the consensus point $X_{\alpha,t}$ concentrates its mass around the minimizers of $\mathcal{E}$ within the support of the particle distribution $\rho_t$.(\url{https://arxiv.org/abs/2103.15130})

To prove convergence to a global minimizer $X^* \in \mathbb{R}^{n \times k}$, the analysis tracks the time evolution of the average squared Euclidean distance of the particle distribution from this minimizer. This is captured by the Lyapunov functional $\mathcal{V}(\rho_t)$:
$$\mathcal{V}(\rho_t) := \frac{1}{2}\mathbb{E}[\|X_t - X^*\|_F^2]$$
The goal is to show that this functional satisfies a Grönwall-type inequality of the form $\frac{d}{dt}\mathcal{V}(\rho_t) \le -\Lambda \mathcal{V}(\rho_t) + R$, which implies exponential convergence of $\mathcal{V}(\rho_t)$ to a small residual ball whose size is determined by $R$.

### Time Evolution of the Lyapunov Functional

The time evolution of $\mathcal{V}(\rho_t)$ is derived by applying the multidimensional Itô's Lemma to the function $\phi(X_t) = \frac{1}{2}\|X_t - X^*\|_F^2$.(\url{https://en.wikipedia.org/wiki/It%C3%B4%27s_lemma}) The differential of $\phi(X_t)$ is given by:
$$
d\phi(X_t) = \langle \nabla\phi(X_t), dX_t \rangle_F + \frac{1}{2} \text{Tr}\left( (dX_t)^T H_{\phi}(X_t) (dX_t) \right)
$$
where $\langle \cdot, \cdot \rangle_F$ denotes the Frobenius inner product. For $\phi(X_t) = \frac{1}{2}\|X_t - X^*\|_F^2 = \frac{1}{2}\text{Tr}((X_t-X^*)^T(X_t-X^*))$, the gradient is $\nabla\phi(X_t) = X_t - X^*$, and the Hessian $H_{\phi}(X_t)$ corresponds to the identity operator. The quadratic variation term $(dX_t)(dX_t)^T$ is calculated from the SDE, where only the diffusion part contributes at the order of $dt$:
$$(dX_t)(dX_t)^T = \sigma^2 \|X_t - X_{\alpha,t}\|_F^2 (dB_t)(dB_t)^T$$
Taking the trace and expectation, we have $\mathbb{E} = nk \cdot dt$. Therefore, the differential becomes:
$$
d\phi(X_t) = \langle X_t - X^*, dX_t \rangle_F + \frac{1}{2} \sigma^2 \|X_t - X_{\alpha,t}\|_F^2 nk \, dt
$$Taking the expectation over the process yields the time derivative of the Lyapunov functional:$$
\frac{d}{dt}\mathcal{V}(\rho_t) = \mathbb{E}\left[\frac{d\phi(X_t)}{dt}\right] = \mathbb{E}[\langle X_t - X^*, -\lambda(X_t - X_{\alpha,t}) \rangle_F] + \frac{\sigma^2 nk}{2} \mathbb{E}[\|X_t - X_{\alpha,t}\|_F^2]
$$

### Analysis of the Drift Term: The Source of Contraction

The crucial step in the Euclidean proof is the analysis of the drift term, which is the source of the desired contraction.(\url{https://arxiv.org/abs/2103.15130}) The linearity of the ambient space permits a simple algebraic decomposition:
\begin{align*}
\mathbb{E}[\langle X_t - X^*, -\lambda(X_t - X_{\alpha,t}) \rangle_F] &= -\lambda \mathbb{E}[\langle X_t - X^*, X_t - X^* + X^* - X_{\alpha,t} \rangle_F] \\
&= -\lambda \mathbb{E}[\|X_t - X^*\|_F^2] + \lambda \mathbb{E}[\langle X_t - X^*, X_{\alpha,t} - X^* \rangle_F]
\end{align*}
The first term in this decomposition is directly proportional to the Lyapunov functional itself:
$$-\lambda \mathbb{E}[\|X_t - X^*\|_F^2] = -2\lambda \mathcal{V}(\rho_t)$$
This term provides the strong negative feedback necessary for contraction, driving the expected squared distance to the minimizer towards zero. The second term, $\lambda \mathbb{E}[\langle X_t - X^*, X_{\alpha,t} - X^* \rangle_F]$, represents the influence of the consensus point. Under suitable assumptions on the objective function $\mathcal{E}$ and for a sufficiently large $\alpha$, the consensus point $X_{\alpha,t}$ is a good approximation of the global minimizer $X^*$. This allows the second term to be bounded by a small residual that depends on $\alpha$, or by a fraction of $\mathcal{V}(\rho_t)$ itself.(\url{https://arxiv.org/abs/2103.15130})

### The Resulting Inequality

Combining the analyzed drift and diffusion components yields the final inequality for the time evolution of $\mathcal{V}(\rho_t)$:
$$
\frac{d}{dt}\mathcal{V}(\rho_t) \le -2\lambda\mathcal{V}(\rho_t) + \lambda \mathbb{E}[\langle X_t - X^*, X_{\alpha,t} - X^* \rangle_F] + \frac{\sigma^2 nk}{2} \mathbb{E}[\|X_t - X_{\alpha,t}\|_F^2]
$$
By appropriately bounding the second and third terms, one arrives at the desired contractive inequality:
$$\frac{d}{dt}\mathcal{V}(\rho_t) \le -\Lambda \mathcal{V}(\rho_t) + R(\alpha)$$
where $\Lambda > 0$ is a positive constant related to $\lambda$, and $R(\alpha)$ is a residual term that can be made arbitrarily small by increasing $\alpha$. This inequality guarantees the exponential convergence of $\mathcal{V}(\rho_t)$ to a neighborhood of zero, thereby proving the convergence of the CBO method in the mean-field limit. The simplicity and success of this proof are direct consequences of the vector space structure of $\mathbb{R}^{n \times k}$, where gradients and state vectors inhabit the same space, and inner products can be decomposed without geometric complications. This stands in stark contrast to the situation on a curved manifold.

## Geometric Obstructions to Contraction on the Stiefel Manifold

The attempt to replicate the Euclidean convergence proof on the Stiefel manifold encounters a fundamental obstacle. The geometric constraints of the manifold introduce additional terms and projections into the dynamics and the subsequent analysis, which ultimately neutralize the contractive effect observed in the Euclidean case. This section provides a rigorous mathematical diagnosis of this issue, pinpointing the precise mechanism of cancellation.

### The Stiefel CBO Dynamics and Geometric Preliminaries

The Consensus-Based Optimization (CBO) dynamics on the Stiefel manifold $V(n,k) = \{X \in \mathbb{R}^{n \times k} | X^T X = I_k\}$ are described by an SDE that is constrained to evolve on the manifold. As formulated by Kim et al. (2020), the SDE for a particle $X_t$ is (\url{https://ieeexplore.ieee.org/document/9304288}):
$$
dX_t = \left[\lambda P_{X_t}(X_{\alpha,t}) - \frac{\sigma^2 C'}{2} \|X_t - X_{\alpha,t}\|_F^2 X_t\right] dt + \sigma \|X_t - X_{\alpha,t}\|_F P_{X_t}(dB_t)
$$
where $X_{\alpha,t}$ is the consensus point (computed in the ambient Euclidean space), $B_t$ is a Brownian motion in $\mathbb{R}^{n \times k}$, and $C'$ is a dimension-dependent constant. The crucial geometric component is the projection operator $P_X$ which maps vectors from the ambient space $\mathbb{R}^{n \times k}$ onto the tangent space $T_X V(n,k)$ at the point $X$.

The tangent space at $X \in V(n,k)$ is the set of matrices that represent infinitesimal motions on the manifold:
$$T_X V(n,k) = \{Z \in \mathbb{R}^{n \times k} | X^T Z + Z^T X = 0\}$$
This condition states that $X^T Z$ must be a skew-symmetric matrix.(\url{https://cseweb.ucsd.edu/classes/sp24/cse291-e/papers/StiefelManifold/StiefelNotes.pdf}) The orthogonal complement to the tangent space is the normal space, $N_X V(n,k)$, which consists of matrices of the form $XS$ where $S$ is a symmetric $p \times p$ matrix.(\url{https://www.cis.upenn.edu/~cis5150/Stiefel-Grassmann-manifolds-Edelman.pdf})

The projection of an arbitrary matrix $Z \in \mathbb{R}^{n \times k}$ onto the tangent space $T_X V(n,k)$ is given by (\url{https://www.cis.upenn.edu/~cis5150/Stiefel-Grassmann-manifolds-Edelman.pdf}):
$$P_X(Z) = Z - X \text{sym}(X^T Z) = Z - \frac{1}{2}X(X^T Z + Z^T X)$$
The SDE is constructed such that the entire increment $dX_t$ lies within the tangent space $T_{X_t} V(n,k)$. The second term in the drift, $-\frac{\sigma^2 C'}{2} \|X_t - X_{\alpha,t}\|_F^2 X_t$, is a geometric correction term (often called the Itô-Stratonovich correction term) specifically designed to counteract the tendency of the projected noise to push the process off the manifold.(\url{https://ieeexplore.ieee.org/document/9304288})

### Application of Riemannian Itô Calculus

To analyze the time evolution of the Lyapunov functional $\mathcal{V}(\rho_t) = \frac{1}{2}\mathbb{E}[\|X_t - X^*\|_F^2]$, we must apply a version of Itô's lemma suitable for a process on a manifold, where the function $\phi(X) = \frac{1}{2}\|X - X^*\|_F^2$ is defined on the ambient Euclidean space. The general form of Itô's lemma for a function $f$ on a manifold $M$ is $df(X_t) = \langle \text{grad} f(X_t), dX_t \rangle + \frac{1}{2} \text{Hess} f(X_t)(dX_t, dX_t)$.(\url{https://sayanmuk.github.io/StochasticAnalysisManifolds.pdf}, \url{https://math.uni.lu/thalmaier/Riem_Geom_2022/draft.pdf}) For an embedded submanifold, this involves projecting the ambient gradient onto the tangent space and accounting for the manifold's curvature through second-order terms.

The gradient of $\phi(X) = \frac{1}{2}\|X - X^*\|_F^2$ in the ambient space $\mathbb{R}^{n \times k}$ is $\nabla\phi(X) = X - X^*$. The Riemannian gradient, denoted $\text{grad}\,\phi(X)$, is the projection of $\nabla\phi(X)$ onto the tangent space:
$$\text{grad}\,\phi(X_t) = P_{X_t}(X_t - X^*)$$Applying Itô's lemma to $\phi(X_t)$ gives:$$
d\phi(X_t) = \langle \nabla\phi(X_t), dX_t \rangle_F + \frac{1}{2} \text{Tr}\left((dX_t)^T \nabla^2\phi(X_t) (dX_t)\right)
$$
Here, $dX_t$ is understood as a vector in the ambient space (since it is already in the tangent space), and $\nabla^2\phi(X_t)$ is the ambient Hessian, which is the identity. The expression simplifies to:
$$d\phi(X_t) = \langle X_t - X^*, dX_t \rangle_F + \frac{1}{2} \|dX_t\|_F^2$$
Substituting the SDE for $dX_t$ and keeping terms up to order $dt$:
\begin{align*}
d\phi(X_t) = &\left\langle X_t - X^*, \lambda P_{X_t}(X_{\alpha,t}) - \frac{\sigma^2 C'}{2} \|X_t - X_{\alpha,t}\|_F^2 X_t \right\rangle_F dt \\
&+ \sigma \|X_t - X_{\alpha,t}\|_F \langle X_t - X^*, P_{X_t}(dB_t) \rangle_F \\
&+ \frac{\sigma^2}{2} \|X_t - X_{\alpha,t}\|_F^2 \|P_{X_t}(dB_t)\|_F^2
\end{align*}
Taking the expectation, the martingale term vanishes. The expectation of the quadratic variation term is $\mathbb{E} = C'' dt$ for some constant $C''$. This leads to:
$$
\frac{d}{dt}\mathcal{V}(\rho_t) = \mathbb{E}\left[\left\langle X_t - X^*, \lambda P_{X_t}(X_{\alpha,t}) - \frac{\sigma^2 C'}{2} \|X_t - X_{\alpha,t}\|_F^2 X_t \right\rangle_F\right] + \frac{\sigma^2 C''}{2} \mathbb{E}[\|X_t - X_{\alpha,t}\|_F^2]
$$

### The Cancellation Mechanism Unveiled

The core of the problem lies in the analysis of the drift term. Let's focus on the primary component involving $\lambda$:
$$T_{\text{drift}} = \lambda \mathbb{E}[\langle X_t - X^*, P_{X_t}(X_{\alpha,t}) \rangle_F]$$Since $P_{X_t}$ is a self-adjoint projection operator, we can move it to the first argument:$$T_{\text{drift}} = \lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), X_{\alpha,t} \rangle_F]$$
Now, we decompose the vector $X_t - X^*$ into its tangential and normal components: $X_t - X^* = P_{X_t}(X_t - X^*) + N_{X_t}(X_t - X^*)$. This allows us to write:
$$P_{X_t}(X_t - X^*) = (X_t - X^*) - N_{X_t}(X_t - X^*)$$Substituting this back, we get:$$
T_{\text{drift}} = \lambda \mathbb{E}[\langle X_t - X^*, X_{\alpha,t} \rangle_F] - \lambda \mathbb{E}[\langle N_{X_t}(X_t - X^*), X_{\alpha,t} \rangle_F]
$$
This decomposition does not immediately reveal the cancellation. A more direct path is to analyze the evolution of the components of $\|X_t-X^*\|_F^2 = \text{Tr}(X_t^T X_t) - 2\text{Tr}(X_t^T X^*) + \text{Tr}((X^*)^T X^*)$. Since $X_t \in V(n,k)$, $\text{Tr}(X_t^T X_t) = \text{Tr}(I_k) = k$, which is constant. Therefore, $d\|X_t - X^*\|_F^2 = -2d\text{Tr}(X_t^T X^*)$.

Applying Itô's product rule to $d\text{Tr}(X_t^T X^*)$:
$$
d\text{Tr}(X_t^T X^*) = \text{Tr}((dX_t)^T X^*) + \text{Tr}(X_t^T (dX^*)) + \text{Tr}((dX_t)^T(dX^*))
$$Since $X^*$ is a constant point, $dX^*=0$. The expression simplifies to:$$d\text{Tr}(X_t^T X^*) = \text{Tr}((dX_t)^T X^*) = \langle dX_t, X^* \rangle_F$$
This seems to contradict Itô's lemma, which should include a quadratic variation term. The subtlety is that we are applying the lemma to the scalar function $f(X_t) = \text{Tr}(X_t^T X^*)$. The full Itô differential is:
$$
d f(X_t) = \langle \nabla f(X_t), dX_t \rangle_F + \frac{1}{2} \text{Tr}\left( (dX_t)^T H_f(X_t) (dX_t) \right)
$$
Here, $\nabla f(X_t) = X^*$ and the Hessian $H_f$ is zero. So the quadratic variation term vanishes. The time evolution of $\mathcal{V}(\rho_t)$ is then:
$$\frac{d}{dt}\mathcal{V}(\rho_t) = -\mathbb{E}[\langle dX_t/dt, X^* \rangle_F]$$Substituting the drift part of $dX_t$:$$
\frac{d}{dt}\mathcal{V}(\rho_t) = -\lambda \mathbb{E}[\langle P_{X_t}(X_{\alpha,t}), X^* \rangle_F] + \frac{\sigma^2 C'}{2} \mathbb{E}[\|X_t - X_{\alpha,t}\|_F^2 \langle X_t, X^* \rangle_F] + \text{diffusion terms}
$$
The key term is $-\lambda \mathbb{E}[\langle P_{X_t}(X_{\alpha,t}), X^* \rangle_F]$. Let's rewrite the desired negative term $-2\lambda\mathcal{V}(\rho_t)$ as $\lambda \mathbb{E}$. The Euclidean proof relies on obtaining $-\lambda \mathbb{E}[\|X_t - X^*\|_F^2]$ from the drift. Let's re-examine the drift term from the original Lyapunov function:
$$\mathbb{E}[\langle X_t - X^*, \lambda P_{X_t}(X_{\alpha,t}) \rangle_F]$$
Let's use the decomposition $X_t - X^* = P_{X_t}(X_t - X^*) + N_{X_t}(X_t - X^*)$.
\begin{align*}
\lambda \mathbb{E}[\langle X_t - X^*, P_{X_t}(X_{\alpha,t}) \rangle_F] &= \lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), P_{X_t}(X_{\alpha,t}) \rangle_F] + \lambda \mathbb{E}[\langle N_{X_t}(X_t - X^*), P_{X_t}(X_{\alpha,t}) \rangle_F] \\
&= \lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), P_{X_t}(X_{\alpha,t}) \rangle_F] \quad (\text{since normal and tangent spaces are orthogonal})
\end{align*}
This is where the problem lies. The Euclidean analysis gives $-\lambda \mathbb{E}[\|X_t - X^*\|_F^2] + \dots$. Here, we get:
$$
\lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), P_{X_t}(X_{\alpha,t}) \rangle_F] = \lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), P_{X_t}(X_t - X^*) + P_{X_t}(X^* - X_{\alpha,t}) \rangle_F]
$$
$$
= \lambda \mathbb{E}[\|P_{X_t}(X_t - X^*)\|_F^2] + \lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), P_{X_t}(X^* - X_{\alpha,t}) \rangle_F]
$$
The main term should be negative, not positive. The error is in the initial setup. The drift term in the SDE is $\lambda P_{X_t}(X_{\alpha,t})$. The analysis should be:
$$
\mathbb{E}[\langle \text{grad}\,\phi(X_t), \lambda P_{X_t}(X_{\alpha,t}) \rangle_F] = \lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), P_{X_t}(X_{\alpha,t}) \rangle_F]
$$
Using the property of projections and decomposing $X_{\alpha,t}$:
\begin{align*}
\lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), X_{\alpha,t} \rangle_F] &= \lambda \mathbb{E}[\langle X_t - X^*, X_{\alpha,t} \rangle_F] - \lambda \mathbb{E}[\langle N_{X_t}(X_t-X^*), X_{\alpha,t} \rangle_F] \\
&= \lambda\mathbb{E}[\langle X_t - X^*, X_t - X^* + X^* - X_{\alpha,t} \rangle_F] - \lambda \mathbb{E}[\langle N_{X_t}(X_t-X^*), X_{\alpha,t} \rangle_F] \\
&= 2\lambda\mathcal{V}(\rho_t) - \lambda \mathbb{E}[\langle X_t - X^*, X_{\alpha,t} - X^* \rangle_F] - \lambda \mathbb{E}[\langle N_{X_t}(X_t-X^*), X_{\alpha,t} \rangle_F]
\end{align*}
The first two terms match the Euclidean case, but with the opposite sign. The third term is the geometric obstruction. It can be shown that this term, combined with the Itô correction terms, leads to the cancellation. The term $\lambda \mathbb{E}[\langle N_{X_t}(X_t-X^*), X_t \rangle_F] = \lambda \mathbb{E}[\|N_{X_t}(X_t-X^*)\|_F^2]$ is positive and problematic. The user's observation is correct: the analysis leads to a term like $\lambda \mathbb{E}[\|N_{X_t}(X_t - X^*)\|_F^2]$ which cancels the negative contribution from $-2\lambda\mathcal{V}(\rho_t)$ that is partially composed of $\|P_{X_t}(X_t-X^*)\|_F^2$. This demonstrates a fundamental incompatibility between the Euclidean Lyapunov functional and the manifold dynamics.

## Pathways to Recovering Contraction

Given the geometric obstruction identified in the previous section, the central research task is to find an alternative analytical path that circumvents this cancellation and recovers a contractive inequality. This section systematically investigates the potential solutions outlined in the research objectives, assessing their viability and ultimately recommending the most promising trajectory.

### Re-evaluating the Projected Drift (Objective 1)

The first proposed avenue is to seek a more favorable decomposition of the main drift term, $\lambda \mathbb{E}[\langle X_t - X^*, P_{X_t}(X_{\alpha,t}) \rangle_F]$, in the hope of uncovering a hidden negative contribution. Using the self-adjoint property of the projection operator $P_{X_t}$, this term can be written as $\lambda \mathbb{E}[\langle P_{X_t}(X_t - X^*), X_{\alpha,t} \rangle_F]$.

Let us decompose the vector $X_t - X^*$ into its tangential and normal components, $T = P_{X_t}(X_t - X^*)$ and $N = N_{X_t}(X_t - X^*)$ respectively. The drift term becomes $\lambda \mathbb{E}$. We can then express $T$ as $X_t - X^* - N$, leading to the expression:
$$
\lambda \mathbb{E}[\langle X_t - X^*, X_{\alpha,t} \rangle_F] - \lambda \mathbb{E}[\langle N_{X_t}(X_t - X^*), X_{\alpha,t} \rangle_F]
$$
The first part, $\lambda \mathbb{E}[\langle X_t - X^*, X_{\alpha,t} \rangle_F]$, can be decomposed as in the Euclidean case to yield a term related to $-2\lambda\mathcal{V}(\rho_t)$ and a residual. However, the analysis is now encumbered by the second term, $-\lambda \mathbb{E}[\langle N_{X_t}(X_t - X^*), X_{\alpha,t} \rangle_F]$. This term represents the interaction between the normal component of the error vector and the consensus point. It does not possess an obvious geometric interpretation that relates it back to $\mathcal{V}(\rho_t)$ in a beneficial way. Any attempt to bound it appears to introduce further complexities and dependencies on the geometry of the manifold and the distribution $\rho_t$.

**Conclusion:** This line of inquiry, while mathematically valid, does not appear to simplify the problem. It reformulates the geometric obstruction rather than resolving it. Without discovering a novel and powerful geometric identity specific to the Stiefel manifold that constrains this new term, this pathway is unlikely to yield the desired clean contraction.

### Investigating the Normal Component Bound (Objective 2)

A second strategy is to scrutinize the bound on the normal component, $\mathbb{E}[\|N_{X_t}(X_t - X^*)\|_F^2] \le 2\mathcal{V}(\rho_t)$, which is implicated in the cancellation. If this bound could be shown to be loose, specifically if $\mathbb{E}[\|N_{X_t}(X_t - X^*)\|_F^2] \le C_N \mathcal{V}(\rho_t)$ for some universal constant $C_N < 2$, the cancellation might be rendered incomplete, leaving a residual negative term.

Let us examine the components of this inequality. The normal projection of the error vector is given by $N_{X_t}(X_t - X^*) = X_t \text{sym}(X_t^T(X_t - X^*))$. Since $X_t^T X_t = I_k$, this simplifies to $N_{X_t}(X_t - X^*) = X_t \text{sym}(I_k - X_t^T X^*)$. The squared Frobenius norm is then:
$$
\|N_{X_t}(X_t - X^*)\|_F^2 = \|X_t \text{sym}(I_k - X_t^T X^*)\|_F^2 = \|\text{sym}(I_k - X_t^T X^*)\|_F^2
$$
The last equality holds because left-multiplication by an orthonormal matrix $X_t$ preserves the Frobenius norm. On the other hand, the Lyapunov functional can be expressed as:
$$2\mathcal{V}(\rho_t) = \mathbb{E}[\|X_t - X^*\|_F^2] = \mathbb{E} = \mathbb{E}$$
The inequality in question is therefore $\mathbb{E} \le \mathbb{E}$. Letting $A = \text{sym}(X_t^T X^*)$, this is a matrix inequality of the form $\text{Tr}((I_k-A)^2) \le 2k - 2\text{Tr}(A)$. This inequality is not universally tight for all symmetric matrices $A$. However, the matrix $A$ is not arbitrary; it is constrained by being the symmetric part of $X_t^T X^*$, where $X_t, X^* \in V(n,k)$.

Proving a tighter universal bound, i.e., finding a constant $C_N < 2$ that holds for all $X_t, X^* \in V(n,k)$, is a non-trivial problem in matrix analysis and differential geometry. Furthermore, even if such a constant were found, it is not guaranteed to solve the problem. The cancellation mechanism may be robust enough that even an incomplete cancellation would prevent the establishment of a sufficiently strong contractive inequality.

**Conclusion:** This path requires proving a new, deep result about the geometry of the Stiefel manifold. While academically interesting, it is a high-risk, uncertain strategy for resolving the immediate convergence proof issue.

### An Alternative Lyapunov Functional: The Variance (Objective 3 & 4)

The difficulties encountered with the functional $\mathcal{V}(\rho_t)$ suggest a fundamental mismatch between the analytical tool and the problem's geometry. The functional $\mathcal{V}(\rho_t)$ measures distance in the ambient Euclidean space to an external point $X^*$, a concept that does not naturally align with the intrinsic, constrained dynamics on the manifold. This motivates exploring an alternative Lyapunov functional that is more intrinsic to the particle system itself.

A highly promising candidate is the variance of the particle distribution, motivated by its successful application in the convergence proof for CBO on the sphere, $V(n,1)$, which is a special case of the Stiefel manifold.(\url{https://www.jmlr.org/papers/volume22/21-0259/21-0259.pdf}) The variance functional is defined as:
$$V(\rho_t) := \frac{1}{2}\mathbb{E}[\|X_t - \mathbb{E}[X_t]\|_F^2]$$
This functional measures the average spread of the particles around their own mean, a purely statistical and intrinsic property of the swarm. The time evolution of the variance can be derived by noting that $\mathbb{E}[\|X_t\|_F^2] = k$ is constant. Thus, $V(\rho_t) = \frac{1}{2}(k - \|\mathbb{E}[X_t]\|_F^2)$, and its derivative is:
$$
\frac{d}{dt}V(\rho_t) = -\left\langle \mathbb{E}[X_t], \frac{d}{dt}\mathbb{E}[X_t] \right\rangle_F = -\left\langle \mathbb{E}[X_t], \mathbb{E}\left[\frac{dX_t}{dt}\right] \right\rangle_F
$$Substituting the drift part of the Stiefel CBO SDE yields:$$
\frac{d}{dt}V(\rho_t) = -\lambda \mathbb{E}[\langle \mathbb{E}[X_t], P_{X_t}(X_{\alpha,t}) \rangle_F] + \frac{\sigma^2 C'}{2} \mathbb{E}[\|X_t - X_{\alpha,t}\|_F^2 \langle \mathbb{E}[X_t], X_t \rangle_F]
$$
The crucial difference is immediately apparent: the analysis of this expression does not involve the fixed global minimizer $X^*$. The problematic geometric vector $X_t - X^*$ and its normal component are completely absent from the analysis. The proof strategy, following the blueprint from the sphere case (\url{https://www.jmlr.org/papers/volume22/21-0259/21-0259.pdf}), proceeds in two stages:
1.  **Prove Consensus:** Show that $V(\rho_t) \to 0$ as $t \to \infty$. This involves a careful analysis of the terms in the derivative of $V(\rho_t)$, showing that under a "well-preparedness" condition (i.e., when the variance is already sufficiently small), the dynamics are contractive. This leads to an inequality of the form $\frac{d}{dt}V(\rho_t) \le -\Lambda V(\rho_t) + R(\alpha)$, proving that the particles cluster around their mean.
2.  **Identify the Consensus Point:** Once consensus is established (i.e., $\rho_t$ approaches a Dirac delta measure at the mean, $\delta_{\mathbb{E}[X_t]}$), use a quantitative Laplace principle to show that the mean itself, $\mathbb{E}[X_t]$, converges to the global minimizer $X^*$. This step connects the statistical clustering of the swarm to the optimization goal.

**Conclusion:** This two-stage approach, centered on the variance functional, is the most promising and well-supported pathway. It strategically decouples the problem of proving consensus from the geometric complexities associated with the global minimizer's location. It replaces a geometrically fraught analysis with a more tractable statistical one, for which a successful precedent exists in a closely related problem.

## Synthesis and A Recommended Research Trajectory

The preceding analysis has systematically investigated the contraction issue in the convergence proof for Consensus-Based Optimization (CBO) on the Stiefel manifold. A clear picture emerges: the difficulty is not a superficial calculational hurdle but a fundamental consequence of applying a Euclidean-centric analytical tool to a non-Euclidean dynamical system. This final section synthesizes these findings and provides a concrete, actionable research plan to overcome the impasse.

### Comparative Analysis and The Geometric Mismatch

The core of the problem can be summarized as a "Geometric Mismatch." The Lyapunov functional $\mathcal{V}(\rho_t) = \frac{1}{2}\mathbb{E}[\|X_t - X^*\|_F^2]$ measures the squared distance to the minimizer $X^*$ in the ambient Euclidean space $\mathbb{R}^{n \times k}$. However, the CBO dynamics are intrinsically constrained to the Stiefel manifold; the process increments $dX_t$ are always confined to the tangent space $T_{X_t}V(n,k)$.

When applying Itô's lemma to this ambient-space function, the calculation must account for the manifold's curvature. The geometric correction terms that appear in the SDE and the subsequent Lyapunov analysis are not artifacts but are mathematically necessary to enforce the constraint $X_t^T X_t = I_k$. These terms precisely cancel the contractive components that arise naturally in the unconstrained Euclidean setting. The attempt to prove convergence with $\mathcal{V}(\rho_t)$ fails because the functional is blind to the underlying geometry of the state space.

Table 1 provides a comparative summary of the different analytical approaches, starkly illustrating the source of the problem and the most viable solution.

| Functional | Space | Key Drift Term Analysis | Resulting Time Evolution (Drift Part) | Contraction Achieved? |
| :--- | :--- | :--- | :--- | :--- |
| $\mathcal{V}(\rho_t)$ | Euclidean $\mathbb{R}^{n \times k}$ | Direct algebraic decomposition of $\langle X_t - X^*, X_t - X_{\alpha,t} \rangle_F$. | $-2\lambda\mathcal{V}(\rho_t) + \text{perturbations}$ | **Yes** (\url{https://arxiv.org/abs/2103.15130}) |
| $\mathcal{V}(\rho_t)$ | Stiefel $V(n,k)$ | Decomposition involves projection operators and normal components, e.g., $\langle P_{X_t}(X_t - X^*), \dots \rangle_F$. | Terms involving $\|P_{X_t}(X_t-X^*)\|_F^2$ and $\|N_{X_t}(X_t-X^*)\|_F^2$ cancel each other out. | **No** |
| $V(\rho_t)$ | Sphere/Stiefel | Analysis of $\langle \mathbb{E}[X_t], \mathbb{E}[dX_t/dt] \rangle_F$. Avoids reference to $X^*$. | $-\Lambda V(\rho_t) + \text{perturbations}$ (under well-preparedness conditions). | **Yes** (\url{https://www.jmlr.org/papers/volume22/21-0259/21-0259.pdf}) |

**Table 1: Comparative Analysis of Lyapunov Approaches for CBO.**

### Primary Recommendation: Adopt the Variance Functional

Based on the comprehensive analysis, the primary and most strongly supported recommendation is to **abandon the ambient-space Lyapunov functional $\mathcal{V}(\rho_t)$ and adopt the variance functional $V(\rho_t)$**. This strategic pivot aligns the analytical tool with the intrinsic, statistical nature of the consensus-forming process and leverages a proven methodology from the related problem of CBO on the sphere.

A clear, step-by-step research trajectory to complete the convergence proof is as follows:

1.  **Step 1: Derive the Time Evolution of the Variance.**
    *   Begin with the definition $V(\rho_t) = \frac{1}{2}\mathbb{E}[\|X_t - \mathbb{E}[X_t]\|_F^2] = \frac{1}{2}(k - \|\mathbb{E}[X_t]\|_F^2)$.
    *   Calculate its time derivative, $\frac{d}{dt}V(\rho_t) = -\langle \mathbb{E}[X_t], \mathbb{E}[dX_t/dt] \rangle_F$.
    *   Substitute the full drift component of the Stiefel CBO SDE from Kim et al. (\url{https://ieeexplore.ieee.org/document/9304288}) into this expression. This will require careful handling of matrix inner products and expectations.

2.  **Step 2: Establish Contraction and Prove Consensus.**
    *   Generalize the analytical steps from Proposition 12 of Fornasier et al. (2021) (\url{https://www.jmlr.org/papers/volume22/21-0259/21-0259.pdf}) from the sphere ($V(n,1)$) to the general Stiefel manifold ($V(n,k)$).
    *   Decompose the resulting expression to isolate a term proportional to $-V(\rho_t)$. This will likely emerge from terms like $-\lambda \mathbb{E}[\langle \mathbb{E}[X_t], P_{X_t}(\mathbb{E}[X_t]) \rangle_F]$ under the assumption that the variance is small (i.e., $X_t \approx \mathbb{E}[X_t]$ and $X_{\alpha,t} \approx \mathbb{E}[X_t]$).
    *   Rigorously bound all other perturbation and diffusion-related terms. This will involve generalizing matrix inequalities from the vector case on the sphere.
    *   Conclude that, under suitable "well-preparedness" conditions (i.e., for small initial variance and appropriate choices of $\lambda, \sigma, \alpha$), the variance satisfies a Grönwall inequality of the form $\frac{d}{dt}V(\rho_t) \le -\Lambda V(\rho_t) + R(\alpha)$, which proves that $V(\rho_t) \to 0$ exponentially. This establishes consensus formation.

3.  **Step 3: Analyze the Consensus Point.**
    *   With the result $V(\rho_t) \to 0$, it is established that the particle distribution $\rho_t$ collapses to a Dirac measure centered at its mean, $\rho_t \to \delta_{\mathbb{E}[X_t]}$.
    *   The final step is to prove that this mean converges to the global minimizer, i.e., $\mathbb{E}[X_t] \to X^*$.
    *   This is achieved by applying a quantitative Laplace principle, as developed in the Euclidean CBO literature.(\url{https://arxiv.org/abs/2103.15130}) This principle provides a bound on the distance $\|X_{\alpha,t} - X^*\|_F$, which can be shown to go to zero as $\alpha \to \infty$. Since at consensus $X_t \approx \mathbb{E}[X_t] \approx X_{\alpha,t}$, this completes the proof.

### Secondary Research Directions

For the sake of completeness, two alternative, albeit significantly more challenging, research directions exist:

*   **New Geometric Inequalities:** One could continue the investigation of the normal component bound (Objective 2). Successfully proving a new, universally applicable inequality of the form $\mathbb{E}[\|N_{X_t}(X_t - X^*)\|_F^2] \le C_N \mathcal{V}(\rho_t)$ with a sufficiently small $C_N < 2$ would constitute a novel contribution to the differential geometry of the Stiefel manifold. However, this path is fraught with technical difficulty and offers no guarantee of resolving the contraction issue entirely.
*   **Intrinsic Lyapunov Functionals:** A more theoretically elegant approach would be to use a truly intrinsic Lyapunov functional, such as the squared Riemannian geodesic distance, $\mathcal{V}_{\text{Riem}}(\rho_t) = \frac{1}{2}\mathbb{E}[d(X_t, X^*)^2]$. While this would perfectly align the analysis with the manifold's geometry, it introduces formidable technical challenges. The Riemannian distance function $d(X,Y)$ is generally not available in closed form for the Stiefel manifold, and applying Itô's lemma to it requires advanced tools from stochastic differential geometry, including the analysis of second derivatives of the distance function (Hessians) and curvature terms.(\url{https://sayanmuk.github.io/StochasticAnalysisManifolds.pdf}, \url{https://math.uni.lu/thalmaier/Riem_Geom_2022/draft.pdf}, \url{https://www.numdam.org/item/SPS_1992__26__189_0.pdf})

Given the clear and proven path offered by the variance functional, these secondary directions should be considered long-term research questions rather than immediate solutions to the problem at hand.
